{"version":3,"sources":["../../src/components/table.component.ts"],"names":[],"mappings":"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","file":"table.component.js","sourceRoot":"","sourcesContent":["import { Component, Input, Output, OnInit, AfterViewInit, OnDestroy, EventEmitter } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { NgTableSource } from '../ngtable.source';\nimport { INgTableSourceParams } from '../ngtable.params';\nimport { NgTableSourceResult } from '../ngtable.result';\nimport { NgTableInitEvent, NgTableRangeEvent, NgTableBeforeConnectEvent, NgTableAfterConnectEvent, NgTableDestroyEvent } from '../ngtable.events';\nimport { Observable } from 'rxjs/Rx';\n\n\nexport class NgTable implements OnInit, AfterViewInit, OnDestroy {\n\n  private _dataSourceSubscriber: any;\n\n  private _rows: Array<any> = [];\n  private _totalRows: number = 0;\n  private _page: number = 1;\n  private _totalPages: number = 0;\n  private _from: number = 0;\n  private _to: number = 0;\n  private _dataSource: NgTableSource;\n  private _initialized: boolean = false;\n  private _queryPage: string = 'page';\n  private _querySubscriber: any;\n\n   initEmitter: EventEmitter<NgTableInitEvent> = new EventEmitter<NgTableInitEvent>();\n   destroyEmitter: EventEmitter<NgTableDestroyEvent> = new EventEmitter<NgTableDestroyEvent>();\n   beforeConnectEmitter: EventEmitter<NgTableBeforeConnectEvent> = new EventEmitter<NgTableBeforeConnectEvent>();\n   afterConnectEmitter: EventEmitter<NgTableAfterConnectEvent> = new EventEmitter<NgTableAfterConnectEvent>();\n   rangeChangeEmitter: EventEmitter<NgTableRangeEvent> = new EventEmitter<NgTableRangeEvent>();\n\n  constructor(private activeRoute: ActivatedRoute) {\n\n  }\n\n  ngOnInit() {\n\n  }\n\n  ngAfterViewInit() {\n    this.initEmitter.emit(new NgTableInitEvent(this));\n\n    this._querySubscriber = this.activeRoute.queryParams.debounceTime(10).subscribe(params => {\n      this._initialized = true;\n      this._page = params[this._queryPage] ? +params[this._queryPage] : 1;\n\n      this.requestData();\n    });\n  }\n\n  ngOnDestroy() {\n    if (this._dataSourceSubscriber) {\n      this._dataSourceSubscriber.unsubscribe();\n      this._dataSourceSubscriber = null;\n    }\n\n    this._querySubscriber.unsubscribe();\n\n    this.destroyEmitter.emit(new NgTableDestroyEvent(this));\n  }\n\n  \n  set dataSource(source: NgTableSource) {\n    this._dataSource = source;\n\n    if (this._dataSourceSubscriber) {\n      this._dataSourceSubscriber.unsubscribe();\n    }\n\n    this._dataSourceSubscriber = this._dataSource.connection.subscribe((result: NgTableSourceResult) => {\n      if (result) {\n        this._rows = result.data;\n        this._totalRows = result.totalRows;\n        this._totalPages = Math.ceil(this._totalRows / this._dataSource.range);\n\n        if (this._page > this._totalPages) {\n          this._page = 1;\n        }\n\n        this._from = ((this._page - 1) * this._dataSource.range) + 1;\n        this._to = this._from + this._dataSource.range - 1;\n\n        if (this._to > this._totalRows) {\n          this._to = this._totalRows;\n        }\n\n        this.afterConnectEmitter.emit(new NgTableAfterConnectEvent(this, result));\n      }\n    });\n  }\n\n  protected requestData(): void {\n    if (!this._dataSource.loading) {\n      this._dataSource.params.offset = (this._page - 1) * this._dataSource.range;\n\n      this.beforeConnectEmitter.emit(new NgTableBeforeConnectEvent(this, this._dataSource.params));\n\n      this._dataSource.getData(this._dataSource.params);\n    }\n  }\n\n  get rows(): Array<any> {\n    return this._rows;\n  }\n\n  \n  set queryPage(name: string) {\n    this._queryPage = name;\n  }\n\n  get page(): number {\n    return this._page;\n  }\n\n  \n  set page(index: number) {\n    if (!this._dataSource.loading) {\n      this._page = +index;\n\n      if (this._page < 1) {\n        this._page = 1;\n      }\n\n      if (this._page > this._totalPages) {\n        this._page = this._totalPages;\n\n        if (this._page < 1) {\n          this._page = 1;\n        }\n      }\n\n      this.requestData();\n    }\n  }\n\n  get totalPages(): number {\n    return this._totalPages;\n  }\n\n  get totalRows(): number {\n    return this._totalRows;\n  }\n\n  get from(): number{\n    return this._from;\n  }\n\n  get to(): number {\n    return this._to;\n  }\n\n  get range(): number {\n    return this._dataSource.range;\n  }\n\n  \n  set range(value: number) {\n    if (!this._dataSource.loading) {\n      this._dataSource.range = +value;\n      this.rangeChangeEmitter.emit(new NgTableRangeEvent(this, this.range, this.rangeOptions));\n    }\n  }\n\n  get rangeOptions(): Array<number> {\n    return this._dataSource.rangeOptions;\n  }\n\n  \n  set rangeOptions(value: Array<number>) {\n    this._dataSource.rangeOptions = value;\n  }\n\n  get initialized(): boolean {\n    return this._initialized;\n  }\n\n  get loading(): boolean {\n    return this._dataSource.loading;\n  }\n\n  get empty(): boolean {\n    return this._totalRows == 0;\n  }\n\n  refresh(): NgTable {\n    this.page = this._page;\n    return this;\n  }\n\n  prev(): NgTable {\n    this._page--;\n\n    if (this._page < 1) {\n      this._page = 1;\n    }\n\n    this.page = this._page;\n\n    return this;\n  }\n\n  next(): NgTable {\n    this._page++;\n\n    let pagesMax: number = this.totalPages;\n\n    if (this._page > pagesMax) {\n      this._page = pagesMax;\n    }\n\n    this.page = this._page;\n\n    return this;\n  }\n\n  get hasPrev(): boolean {\n    return this._page > 1;\n  }\n\n  get hasNext(): boolean {\n    return this._page < this._totalPages;\n  }\n\n  get isFirst(): boolean {\n    return this._page == 1;\n  }\n\n  get isLast(): boolean {\n    return this._page == this._totalPages;\n  }\n\nstatic decorators: DecoratorInvocation[] = [\n{ type: Component, args: [{\n  selector: 'ng-table',\n  template: `\n  <ng-content></ng-content>\n  `,\n  styleUrls: ['./table.component.scss'],\n  host: {'class': 'ng-table'}\n}, ] },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: ActivatedRoute, },\n];\nstatic propDecorators: {[key: string]: DecoratorInvocation[]} = {\n'initEmitter': [{ type: Output, args: ['init', ] },],\n'destroyEmitter': [{ type: Output, args: ['destroy', ] },],\n'beforeConnectEmitter': [{ type: Output, args: ['beforeConnect', ] },],\n'afterConnectEmitter': [{ type: Output, args: ['afterConnect', ] },],\n'rangeChangeEmitter': [{ type: Output, args: ['rangeChange', ] },],\n'dataSource': [{ type: Input },],\n'queryPage': [{ type: Input },],\n'page': [{ type: Input },],\n'range': [{ type: Input },],\n'rangeOptions': [{ type: Input },],\n};\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}